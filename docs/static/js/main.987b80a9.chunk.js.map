{"version":3,"sources":["../../src/index.js","../../src/App.jsx","../../src/runAppannie.js","../../src/runInstagramIntercept.js","../../src/utils/index.js","../../src/utils/injectCss.js","../../src/utils/injectJs.js","../../src/utils/openTab.js"],"names":["jses","csses","Bluebird","map","item","injectJs","injectCss","console","error","node","document","createElement","ReactDOM","render","React","App","body","appendChild","runAppannie","then","res","log","catch","err","runInstagramIntercept","main","Timer","props","state","seconds","this","setState","interval","setInterval","tick","clearInterval","Component","style","position","zIndex","bottom","left","background","color","width","children","Container","Row","Col","md","src","getObjectValue","path","object","defaultValue","split","Array","isArray","length","key","slicedPath","slice","Object","hasOwnProperty","call","getShortMarketName","fullName","toast","text","type","window","siiimpleToast","fetch","setTimeout","location","reload","href","includes","status","RegExp","test","__NEXT_DATA__","is404Page","innerText","startsWith","pageVal","productId","productTitle","pathname","method","mode","fullMarketName","app_id","String","market_name","companyId","companyName","obj_nav","company","id","name","shortMarketName","productUniversalProductId","product","market","universal_product_id","universalPoductId","universalPoductName","universalPoductIcon","universal_product","icon","publisher","appName","appIcon","_market","storeUrl","exec","marketId","url","URL","urlParams","URLSearchParams","search","get","meta_data","headers","Accept","JSON","stringify","statusText","success","alert","interceptEndpoint","reqBody","sharedDataGetter","_sharedData","entry_data","ProfilePage","profilePage","graphql","user","payload","username","request","response","__lskjs","GM_xmlhttpRequest","data","addXMLRequestCallback","callback","oldSend","oldSetRequestHeader","oldOpen","i","XMLHttpRequest","callbacks","push","prototype","send","setRequestHeader","open","meta","apply","arguments","async","password","addEventListener","value","requestHeaders","xhr","responseHeaders","getAllResponseHeaders","filter","str","forEach","header","responseText","getElementsByTagName","tag","setAttribute","env","isDev","trace","Promise","resolve","reject","GM_addElement","script","onload","openTab","timeout","tab","close"],"mappings":"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","file":"static/js/main.987b80a9.chunk.js","sourcesContent":["/* eslint-disable no-console */\n/* global document */\nimport ready from '@lskjs/utils/polyfill';\nimport Bluebird from 'bluebird';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { App } from './App';\nimport { runAppannie } from './runAppannie';\nimport { runInstagramIntercept } from './runInstagramIntercept';\nimport { injectCss, injectJs } from './utils';\n\nready();\n\nconst jses = ['https://cdn.jsdelivr.net/npm/siiimple-toast/dist/siiimple-toast.min.js'];\nconst csses = [\n  'https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css',\n  'https://cdn.jsdelivr.net/npm/siiimple-toast/dist/style.css',\n];\n\nconst main = async () => {\n  try {\n    await Bluebird.map(jses, (item) => injectJs(item));\n    await Bluebird.map(csses, (item) => injectCss(item));\n  } catch (error) {\n    console.error(error);\n  }\n\n  const node = document.createElement('div');\n  ReactDOM.render(React.createElement(App), node);\n  document.body.appendChild(node);\n  // setTimeout(() => {\n  //   openTab('https://www.instagram.com/elena__valereevna/');\n  // }, 2000);\n\n  // window.__lskjs.GM_xmlhttpRequest({\n  //   method: 'GET',\n  //   url: 'https://worker.buzz.guru/api/healthcheck',\n  //   onload() {\n  //     console.log('onload!!!');\n  //   },\n  //   onerror() {\n  //     console.error('onerror!!!');\n  //   },\n  // });\n\n  runAppannie()\n    .then((res) => {\n      console.log('[runAppannie] ok', res);\n    })\n    .catch((err) => {\n      console.error('[runAppannie] err', err);\n    });\n  runInstagramIntercept()\n    .then((res) => {\n      console.log('[runInstagramIntercept] ok', res);\n    })\n    .catch((err) => {\n      console.error('[runInstagramIntercept] err', err);\n    });\n};\n\nmain();\n","import Button from '@lskjs/button';\nimport { Col, Container, Row } from '@lskjs/grid';\nimport React from 'react';\n\nclass Timer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { seconds: 0 };\n  }\n\n  tick() {\n    this.setState((state) => ({\n      seconds: state.seconds + 1,\n    }));\n  }\n\n  componentDidMount() {\n    this.interval = setInterval(() => this.tick(), 1000);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  render() {\n    return <div>Seconds: {this.state.seconds}</div>;\n  }\n}\n\nconst style = {\n  position: 'fixed',\n  zIndex: 99999,\n  bottom: 0,\n  left: 0,\n  background: 'gray',\n  color: 'white',\n  width: '100%',\n};\n\nexport const App = ({ children }) => (\n  <div style={style}>\n    <Container>\n      <Row>\n        <Col md={6}>\n          <Timer />\n        </Col>\n        <Col md={3}>\n          <img src=\"https://buzzguru.github.io/userscript/logo.png\" />\n        </Col>\n      </Row>\n    </Container>\n  </div>\n);\n\nexport default App;\n","/* global document window fetch */\n\nexport function getObjectValue(path, object, defaultValue = null) {\n  if (typeof path === 'string') {\n    return getObjectValue(path.split(/\\./), object, defaultValue);\n  }\n\n  if (!Array.isArray(path) || path.length === 0) {\n    return defaultValue;\n  }\n\n  const [key] = path;\n  const slicedPath = path.slice(1);\n\n  if (!object || typeof object !== 'object' || !Object.hasOwnProperty.call(object, key)) {\n    return defaultValue;\n  }\n\n  if (slicedPath.length === 0) {\n    return object[key];\n  }\n  return getObjectValue(slicedPath, object[key], defaultValue);\n}\n\nexport function getShortMarketName(fullName) {\n  if (fullName === 'google-play') {\n    return 'gp';\n  }\n  return fullName;\n}\n\nexport function toast(text, { type = 'message' } = {}) {\n  console.log('[toast]', text);\n  if (!window.siiimpleToast) return;\n  window.siiimpleToast[type](text);\n  fetch('/i18n/activate/en/').then(() => {\n    setTimeout(() => {\n      window.location.reload();\n    }, 2000);\n  });\n}\n\n// @match        *://www.appannie.com/ru/apps/ios/app/*/details*\n// @match        *://www.appannie.com/ru/apps/google-play/app/*/details*\n// @match        *://www.appannie.com/ru/apps/*/app/*/details*\n// @match        *://www.appannie.com/apps/ios/app/*/details*\n// @match        *://www.appannie.com/apps/google-play/app/*/details*\n// @match        *://www.appannie.com/apps/*/app/*/details*\n\nexport async function runAppannie() {\n  const location = document?.location?.href || '';\n  if (!location.includes('://www.appannie.com')) return { status: 'ignoreDomain' };\n  const regexp = new RegExp('://www.appannie.com/.*apps/.+/app/.+/details');\n  if (!regexp.test(location)) return { status: 'ignore' };\n\n  // console.log('[runAppannie] @');\n  const { __NEXT_DATA__ } = window;\n  const is404Page = document.body.innerText.startsWith('Oops! 404');\n  if (!is404Page && getObjectValue('props.pageProps.locale.language', __NEXT_DATA__) !== 'en-US') {\n    await toast('Язык страницы не английский, переключаем на английский');\n    return { status: 'changeLocale' };\n  }\n  const pageVal = {\n    location: window.location.href,\n  };\n  const productId = getObjectValue('props.pageProps.app.id', __NEXT_DATA__);\n  const productTitle = getObjectValue('props.pageProps.app.name', __NEXT_DATA__);\n  if (is404Page || !productId || (productTitle && productTitle === 'Unknown Product')) {\n    await fetch(`https://worker.buzz.guru/api/appannie/notFound?location=${document.location.pathname}`, {\n      method: 'POST',\n      mode: 'no-cors',\n    });\n    toast('Спаршено 404', { type: 'alert' });\n    console.log('Отрепорти эту ссылку в чатик');\n    return { status: '404' };\n  }\n\n  const fullMarketName = getObjectValue('props.pageProps.market', __NEXT_DATA__);\n\n  if (productId) {\n    pageVal.app_id = String(productId);\n  }\n\n  if (fullMarketName) {\n    pageVal.market_name = fullMarketName;\n  }\n\n  const companyId = getObjectValue('props.pageProps.company.id', __NEXT_DATA__);\n  const companyName = getObjectValue('props.pageProps.company.name', __NEXT_DATA__);\n\n  if (companyId || companyName) {\n    if (!pageVal.obj_nav) {\n      pageVal.obj_nav = {};\n    }\n    if (!pageVal.obj_nav.company) {\n      pageVal.obj_nav.company = {};\n      if (companyId) {\n        pageVal.obj_nav.company.id = String(companyId);\n      }\n      if (companyName) {\n        pageVal.obj_nav.company.name = companyName;\n      }\n    }\n  }\n\n  const shortMarketName = getShortMarketName(fullMarketName);\n  const productUniversalProductId = getObjectValue('props.pageProps.unifiedApp.id', __NEXT_DATA__);\n\n  if (productId || shortMarketName || productUniversalProductId) {\n    if (!pageVal.obj_nav) {\n      pageVal.obj_nav = {};\n    }\n    if (!pageVal.obj_nav.product) {\n      pageVal.obj_nav.product = {};\n      if (productId) {\n        pageVal.obj_nav.product.id = String(productId);\n      }\n      if (shortMarketName) {\n        pageVal.obj_nav.product.market = shortMarketName;\n      }\n      if (productUniversalProductId) {\n        pageVal.obj_nav.product.universal_product_id = String(productUniversalProductId);\n      }\n    }\n  }\n\n  const universalPoductId = getObjectValue('props.pageProps.unifiedApp.id', __NEXT_DATA__);\n  const universalPoductName = getObjectValue('props.pageProps.unifiedApp.name', __NEXT_DATA__);\n  const universalPoductIcon = getObjectValue('props.pageProps.unifiedApp.icon', __NEXT_DATA__);\n\n  if (universalPoductId || universalPoductName || universalPoductIcon) {\n    if (!pageVal.obj_nav) {\n      pageVal.obj_nav = {};\n    }\n    if (!pageVal.obj_nav.universal_product) {\n      pageVal.obj_nav.universal_product = {};\n      if (universalPoductId) {\n        pageVal.obj_nav.universal_product.id = String(universalPoductId);\n      }\n      if (universalPoductName) {\n        pageVal.obj_nav.universal_product.name = universalPoductName;\n      }\n      if (universalPoductIcon) {\n        pageVal.obj_nav.universal_product.icon = universalPoductIcon;\n      }\n    }\n  }\n\n  const publisher = getObjectValue('props.pageProps.publisher', __NEXT_DATA__);\n  if (publisher) {\n    pageVal.publisher = publisher;\n  }\n\n  const appName = getObjectValue('props.pageProps.app.name', __NEXT_DATA__);\n  const appIcon = getObjectValue('props.pageProps.app.icon', __NEXT_DATA__);\n  const _market = getObjectValue('props.pageProps.app.market', __NEXT_DATA__);\n  const status = getObjectValue('props.pageProps.app.status', __NEXT_DATA__);\n  let market;\n  if (_market === 'google-play') market = 'gp';\n  if (_market === 'apple-store') market = 'ios';\n  const storeUrl = getObjectValue('props.pageProps.app.url', __NEXT_DATA__);\n  let marketId;\n  if (market === 'ios') {\n    const [, id] = /\\/id(\\d+)/.exec(storeUrl);\n    marketId = id;\n  }\n  if (market === 'gp') {\n    const url = new URL(storeUrl);\n    const urlParams = new URLSearchParams(url.search);\n    marketId = urlParams.get('id');\n  }\n  pageVal.meta_data = {};\n  if (appName) {\n    pageVal.meta_data.name = appName;\n  }\n  if (appIcon) {\n    pageVal.meta_data.icon = appIcon;\n  }\n  if (market) {\n    pageVal.meta_data.market = market;\n  }\n  if (marketId) {\n    pageVal.meta_data.marketId = marketId;\n  }\n  if (typeof status === 'number') {\n    pageVal.meta_data.status = status;\n  }\n  try {\n    const res =\n      (await fetch('https://worker.buzz.guru/api/appannie/updateOne', {\n        method: 'post',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(pageVal),\n      })) || {};\n    console.log({ status: res.status, statusText: res.statusText });\n    window.siiimpleToast.success('Приложение спаршено');\n  } catch (e) {\n    window.siiimpleToast.alert('Произошла ошибка при запросе к воркеру');\n  }\n  return { status: 'ok' };\n}\n\nexport default runAppannie;\n","/* eslint-disable no-param-reassign */\n/* global document window XMLHttpRequest */\n\n// @match        *://instagram.com/*\n// @match        *://*.instagram.com/*\n\nconst isDev = 1;\nconst host = isDev ? 'http://127.0.0.1:8000' : 'https://worker.buzz.guru';\nconst interceptEndpoint = `${host}/api/instagram/intercept`;\nconst reqBody = {\n  method: 'POST',\n  url: interceptEndpoint,\n  headers: {\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n  },\n};\n\nfunction sharedDataGetter() {\n  if (\n    window._sharedData &&\n    window._sharedData.entry_data &&\n    window._sharedData.entry_data.ProfilePage &&\n    Array.isArray(window._sharedData.entry_data.ProfilePage) &&\n    window._sharedData.entry_data.ProfilePage.length\n  ) {\n    const profilePage = window._sharedData.entry_data.ProfilePage[0];\n    if (profilePage.graphql && profilePage.graphql.user) {\n      const { user } = profilePage.graphql;\n      const payload = {\n        url: `/${user.username}/?__a=1`,\n        request: {\n          method: 'GET',\n        },\n        response: {\n          text: JSON.stringify(profilePage),\n        },\n      };\n      window.__lskjs.GM_xmlhttpRequest({\n        ...reqBody,\n        data: JSON.stringify(payload),\n      });\n    }\n  }\n}\n\nfunction addXMLRequestCallback(callback) {\n  let oldSend;\n  let oldSetRequestHeader;\n  let oldOpen;\n  let i;\n  if (XMLHttpRequest.callbacks) {\n    XMLHttpRequest.callbacks.push(callback);\n  } else {\n    XMLHttpRequest.callbacks = [callback];\n    oldSend = XMLHttpRequest.prototype.send;\n    oldSetRequestHeader = XMLHttpRequest.prototype.setRequestHeader;\n    oldOpen = XMLHttpRequest.prototype.open;\n    XMLHttpRequest.prototype.send = function (body) {\n      this.meta.body = body;\n      oldSend.apply(this, arguments); // eslint-disable-line prefer-rest-params\n    };\n    XMLHttpRequest.prototype.open = function (method, url, async, user, password) {\n      this.meta = {\n        method,\n        url,\n        async,\n        user,\n        password,\n      };\n      this.addEventListener('load', function () {\n        for (i = 0; i < XMLHttpRequest.callbacks.length; i += 1) {\n          // eslint-disable-line no-plusplus\n          XMLHttpRequest.callbacks[i](this);\n        }\n      });\n      oldOpen.apply(this, arguments); // eslint-disable-line prefer-rest-params\n    };\n    XMLHttpRequest.prototype.setRequestHeader = function (key, value) {\n      if (!this.requestHeaders) {\n        this.requestHeaders = {};\n      }\n      this.requestHeaders[key] = value;\n      oldSetRequestHeader.apply(this, arguments); // eslint-disable-line prefer-rest-params\n    };\n  }\n}\n\nexport async function runInstagramIntercept() {\n  const location = document?.location?.href || '';\n  if (!location.includes('://www.instagram.com')) return { status: 'ignoreDomain' };\n\n  sharedDataGetter();\n\n  addXMLRequestCallback(async (xhr) => {\n    const responseHeaders = {};\n    const responseHeadersArray = xhr\n      .getAllResponseHeaders()\n      .split('\\n')\n      .filter((str) => str);\n    responseHeadersArray.forEach((header) => {\n      const [key, value] = header.split(/: (.+)/);\n      responseHeaders[key] = value;\n    });\n    const payload = {\n      url: xhr.meta.url,\n      request: {\n        method: xhr.meta.method,\n        headers: xhr.requestHeaders,\n        body: xhr.meta.body,\n      },\n      response: {\n        headers: responseHeaders,\n        text: xhr.responseText,\n      },\n    };\n\n    console.log('[R]', payload, interceptEndpoint); // eslint-disable-line no-console\n    window.__lskjs.GM_xmlhttpRequest({\n      ...reqBody,\n      data: JSON.stringify(payload),\n    });\n  });\n  return { status: 'success' };\n}\n\nexport default runInstagramIntercept;\n","export * from './injectCss';\nexport * from './injectJs';\nexport * from './openTab';\n","/* global document */\n\nexport function injectCss(href) {\n  const node = document.getElementsByTagName('head')[0];\n  const tag = document.createElement('link');\n  tag.setAttribute('rel', 'stylesheet');\n  tag.setAttribute('type', 'text/css');\n  tag.setAttribute('href', href);\n  node.appendChild(tag);\n}\n\nexport default injectCss;\n","/* eslint-disable prefer-promise-reject-errors */\n/* global document window GM_addElement */\n/* eslint-disable camelcase */\n\nconst { env, log } = window.__lskjs || {};\nconst { isDev } = env || {};\n\nfunction injectJs(src) {\n  if (isDev) log.trace('[injectJs] start', src);\n  return new Promise((resolve, reject) => {\n    try {\n      if (typeof GM_addElement !== 'undefined') {\n        GM_addElement('script', {\n          src,\n          type: 'text/javascript',\n        });\n      } else {\n        const script = document.createElement('script');\n        script.src = src;\n        script.onload = resolve;\n        script.error = (...args) => {\n          log.error('[injectJs] err', args[0]);\n          return reject(...args);\n        };\n        document.body.appendChild(script);\n      }\n      resolve();\n    } catch (error) {\n      reject(error);\n    }\n    if (isDev) log.trace('[injectJs] success', src);\n  });\n}\n\nexport { injectJs };\n\nexport default injectJs;\n","/* global window */\n\nexport function openTab(href, { timeout = 60000 } = {}) {\n  return new Promise((resolve) => {\n    const tab = window.open(href, '_blank');\n    setTimeout(() => {\n      tab.close();\n      resolve();\n    }, timeout);\n  });\n}\n\nexport default openTab;\n"],"sourceRoot":""}